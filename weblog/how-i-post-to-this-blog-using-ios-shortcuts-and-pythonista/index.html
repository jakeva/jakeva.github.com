<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="In which I describe the formerly automatized process of posting to my blog"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="How I (used to) post to this blog using iOS Shortcuts and Pythonista"><meta property="og:description" content="In which I describe the formerly automatized process of posting to my blog"><meta property="og:type" content="article"><meta property="og:url" content="https://m3ta4a.io/weblog/how-i-post-to-this-blog-using-ios-shortcuts-and-pythonista/"><meta property="article:section" content="weblog"><meta property="article:published_time" content="2020-03-26T00:00:00+00:00"><meta property="article:modified_time" content="2020-03-26T00:00:00+00:00"><title>How I (used to) post to this blog using iOS Shortcuts and Pythonista | m3ta4a</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.c504682006c677abf56f1f91c3fc938accb99eb5e9a6e800521c761b1d2b5f50.css integrity="sha256-xQRoIAbGd6v1bx+Rw/yTisy5nrXppugAUhx2Gx0rX1A="><script defer src=/en.search.min.43da6b19536c22a65eb39d4958949586e04ebd1ab36ff8827ddf095882075523.js integrity="sha256-Q9prGVNsIqZes51JWJSVhuBOvRqzb/iCfd8JWIIHVSM="></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-39509409-1','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a href=/><img src=/fire.gif alt=Logo><span>m3ta4a</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-66bfebd8210b6b4c57d346b0ae18e4f2 class=toggle checked>
<label for=section-66bfebd8210b6b4c57d346b0ae18e4f2 class="flex justify-between"><a href=https://m3ta4a.io/weblog/>Weblog</a></label><ul><li><a href=https://m3ta4a.io/weblog/pony-express/>Pony Express</a></li><li><a href=https://m3ta4a.io/weblog/chess_and_incompleteness/>Chess and Incompleteness</a></li><li><a href=https://m3ta4a.io/weblog/how-i-post-to-this-blog-using-ios-shortcuts-and-pythonista/ class=active>How I (used to) post to this blog using iOS Shortcuts and Pythonista</a></li><li><a href=https://m3ta4a.io/weblog/gpg-yubikey-you/>GPG & YubiKey & You</a></li><li><a href=https://m3ta4a.io/weblog/raspberry-pi-btc-node/>Raspberry Pi BTC Node</a></li><li><a href=https://m3ta4a.io/weblog/diy-nas/>Building my own NAS</a></li></ul></li><li><input type=checkbox id=section-b51db0f6611d8ad86273773125795a51 class=toggle>
<label for=section-b51db0f6611d8ad86273773125795a51 class="flex justify-between"><a href=https://m3ta4a.io/travelog/>Travelog</a></label><ul><li><input type=checkbox id=section-b9a188655b17a4e917fe65d327a0b5d4 class=toggle>
<label for=section-b9a188655b17a4e917fe65d327a0b5d4 class="flex justify-between"><a href=https://m3ta4a.io/travelog/europe-2016/>Europe 2016</a></label><ul><li><input type=checkbox id=section-26e758d33129b1857c408e3e6b3b1696 class=toggle>
<label for=section-26e758d33129b1857c408e3e6b3b1696 class="flex justify-between"><a href=https://m3ta4a.io/travelog/europe-2016/ireland/>Ireland</a></label><ul><li><a href=https://m3ta4a.io/travelog/europe-2016/ireland/dublin/>Dublin</a></li><li><a href=https://m3ta4a.io/travelog/europe-2016/ireland/howth/>Howth</a></li><li><a href=https://m3ta4a.io/travelog/europe-2016/ireland/ferry/>Ferry to France</a></li></ul></li><li><input type=checkbox id=section-9514783f3cbae36d7e63e0622aa6d265 class=toggle>
<label for=section-9514783f3cbae36d7e63e0622aa6d265 class="flex justify-between"><a href=https://m3ta4a.io/travelog/europe-2016/france/>France</a></label><ul><li><a href=https://m3ta4a.io/travelog/europe-2016/france/caen/>Caen</a></li><li><a href=https://m3ta4a.io/travelog/europe-2016/france/paris/>Paris</a><ul><li><a href=https://m3ta4a.io/travelog/europe-2016/france/paris/louvre/>The Louvre</a></li></ul></li></ul></li><li><input type=checkbox id=section-1ccb2a4c04f51d90382aefd698b289a7 class=toggle>
<label for=section-1ccb2a4c04f51d90382aefd698b289a7 class="flex justify-between"><a href=https://m3ta4a.io/travelog/europe-2016/belgium/>Belgium</a></label></li></ul></li><li><a href=https://m3ta4a.io/travelog/cuba-2017/>Cuba 2017</a><ul></ul></li><li><input type=checkbox id=section-79ad5e32044a44b28837acf7abd967c4 class=toggle>
<label for=section-79ad5e32044a44b28837acf7abd967c4 class="flex justify-between"><a href=https://m3ta4a.io/travelog/world-trip-2018/>World Trip 2018</a></label><ul><li><input type=checkbox id=section-1a246094b0cc417869d9b6035a734341 class=toggle>
<label for=section-1a246094b0cc417869d9b6035a734341 class="flex justify-between"><a href=https://m3ta4a.io/travelog/world-trip-2018/china/>China</a></label><ul><li><a href=https://m3ta4a.io/travelog/world-trip-2018/china/shanghai/>Shanghai / Suzhou</a></li><li><a href=https://m3ta4a.io/travelog/world-trip-2018/china/beijing/>Beijing</a></li><li><a href=https://m3ta4a.io/travelog/world-trip-2018/china/chengdu/>Chengdu (Sichuan Province)</a></li></ul></li><li><a href=https://m3ta4a.io/travelog/world-trip-2018/nepal/>Kathmandu, Nepal and The Himalayas / Everest</a></li><li><a href=https://m3ta4a.io/travelog/world-trip-2018/turkey/>Istanbul, Turkey</a></li><li><a href=https://m3ta4a.io/travelog/world-trip-2018/netherlands/>Amsterdam, Netherlands</a><ul></ul></li><li><a href=https://m3ta4a.io/travelog/world-trip-2018/ireland/>Dublin, Ireland</a></li><li><a href=https://m3ta4a.io/travelog/world-trip-2018/new-york-and-home/>New York, and Home</a></li></ul></li></ul></li><li><input type=checkbox id=section-cb04d77833ecfde496d31e3785e012b1 class=toggle>
<label for=section-cb04d77833ecfde496d31e3785e012b1 class="flex justify-between"><a href=https://m3ta4a.io/haikulog/>Haikulog</a></label><ul><li><a href=https://m3ta4a.io/haikulog/2020/>2020</a></li><li><a href=https://m3ta4a.io/haikulog/movie/>Movie</a></li><li><a href=https://m3ta4a.io/haikulog/chris-bacon/>Chris Bacon</a></li><li><a href=https://m3ta4a.io/haikulog/singing/>Singing</a></li><li><a href=https://m3ta4a.io/haikulog/earthquakes/>Earthquakes</a></li><li><a href=https://m3ta4a.io/haikulog/blogs/>Blogs</a></li><li><a href=https://m3ta4a.io/haikulog/food/>Food</a></li><li><a href=https://m3ta4a.io/haikulog/virus/>Virus</a></li><li><a href=https://m3ta4a.io/haikulog/wasting-time/>Wasting time</a></li><li><a href=https://m3ta4a.io/haikulog/haiku/>Haiku</a></li><li><a href=https://m3ta4a.io/haikulog/beer/>Beer</a></li><li><a href=https://m3ta4a.io/haikulog/richard/>Richard</a></li><li><a href=https://m3ta4a.io/haikulog/typos-from-old-books/>Typos from old books</a></li><li><a href=https://m3ta4a.io/haikulog/ramen/>Ramen</a></li><li><a href=https://m3ta4a.io/haikulog/denver/>Denver</a></li><li><a href=https://m3ta4a.io/haikulog/in-defense-of-the-touchbar/>In defense of the new MacBook Pro touchbar</a></li><li><a href=https://m3ta4a.io/haikulog/getting-out-of-bed/>Getting out of bed</a></li><li><a href=https://m3ta4a.io/haikulog/waking-up/>Waking up</a></li><li><a href=https://m3ta4a.io/haikulog/space-time/>Space-time</a></li><li><a href=https://m3ta4a.io/haikulog/evening/>Evening</a></li><li><a href=https://m3ta4a.io/haikulog/breakfast/>Breakfast</a></li><li><a href=https://m3ta4a.io/haikulog/chairs/>Chairs</a></li><li><a href=https://m3ta4a.io/haikulog/bubbles/>Bubbles</a></li><li><a href=https://m3ta4a.io/haikulog/music/>Music</a></li></ul></li><li><a href=https://m3ta4a.io/about/>About</a><ul></ul></li><li><a href=https://m3ta4a.io/now/>Now</a><ul></ul></li><li><a href=https://m3ta4a.io/resume/>Résumé</a><ul></ul></li></ul></nav><script>(function(){var a=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>How I (used to) post to this blog using iOS Shortcuts and Pythonista</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents></nav></aside></header><article class=markdown><h1><a href=/weblog/how-i-post-to-this-blog-using-ios-shortcuts-and-pythonista/>How I (used to) post to this blog using iOS Shortcuts and Pythonista</a></h1><h5>March 26, 2020</h5><div><a href=/categories/diy/>DIY</a></div><p><p>EDIT: This blog is now hosted using Hugo, not Jekyll. I have to find a way to migrate what I&rsquo;ve described here.</p><p>I&rsquo;ve had this blog for many years, and basically never posted anything. I wanted to become better about that, so I&rsquo;ve been writing more haikus and trying to write up some of my home projects. My blog uses <a href=https://jekyllrb.com>Jekyll</a> and is hosted on <a href=https://pages.github.com>Github Pages</a> which already makes it pretty easy to write content but I wanted to see if I could make it even easier. I started with a &ldquo;create new haiku&rdquo; shortcut. This way anytime I have an idea for a haiku it doesn&rsquo;t matter where I am, as long as I have an internet connection on my phone I can post a new one easily.</p><p>So, I began playing with iOS Shortcuts. I wanted a button on my phone that would let me write and post to my blog without needing anything else. The solution I came up with uses a bit of Python in <a href=https://omz-software.com/pythonista/>Pythonista</a> for some formatting, as well as <a href=https://workingcopyapp.com>Working Copy</a> for the git actions.</p><p>Unfornately, the only way to share an iOS shortcut is to share it directly. I wanted to export and paste a JSON payload here or something so others could edit and import easily, but it looks like the only way is to share a public link to it. So, here&rsquo;s my <a href=https://www.icloud.com/shortcuts/7d86a57504eb47098bc7d1290e3239d6>shortcut</a> for writing and posting a haiku. With a little editing it should be easy enough to change if you wanted to rework it to post to your own blog. It assumes you have the Working Copy app I linked above, as well as a Pythonista script.</p><p>Here are the actions it performs:</p><ul><li>Pull the latest changes from your blog repo</li><li>Ask for the name of the Haiku</li><li>Executes a search in <a href=https://giphy.com>Giphy</a> for the given title and lets you choose your favorite gif</li><li>Stages the chosen gif in <code>/assets</code> in your repo</li><li>Asks for the content of the Haiku. Adding an empty line between each line of content renders the content on new lines. I haven&rsquo;t figured this part out yet, but if you don&rsquo;t do this the whole haiku ends up on one line.</li><li>It then sends the input to the Pythonista script to format it as Jekyll front matter</li><li>It takes the resulting formatted content and stages it as a new file in your repo</li><li>It commits the changes to your repo and pushes to remote</li><li>It then texts my girlfriend to let her know there&rsquo;s a new haiku (I haven&rsquo;t tested this with other people, but I expect that unless you have her number it won&rsquo;t work for you)</li></ul><p>So now the only piece missing is the Pythonista script. Here it is:</p><pre><code>from webbrowser import open
from datetime import date
from urllib.parse import quote, unquote
import sys
import x_callback_url

title=sys.argv[1]
body=sys.argv[2]
gif=quote(sys.argv[3])

haiku='''---
layout: haiku
category: Haikus
title: ''' + title + '''
---


''' + body + '''

![--''' + title + '''--](\{\{ site.url \}\}/assets/''' + gif + '''.gif)'''

x_success = sys.argv[-1] # shortcuts-production://x-callback-url/ic-success/&lt;UUID&gt;
x_cancel = x_success.replace('ic-success', 'ic-cancel')
x_error = x_success.replace('ic-success', 'ic-error')

x_success += '?x-source=Pythonista3'
x_success += '&amp;result=' + quote(haiku)
x_success += '&amp;datetime=' + quote(str(date.today().strftime('%Y-%m-%d')))

open(x_success)
</code></pre><p>I&rsquo;ve been having fun with this, I&rsquo;ve also made a version that will make a full blog post like this one but haven&rsquo;t used it much since writing long form on an iOS device is not that convenient for me. Anyway, if you&rsquo;re reading this feel free to play with my shortcut and python script! I&rsquo;d love to hear about any projects you use them for!</p></p></article><script src=https://utteranc.es/client.js repo=m3ta4a/m3ta4a.github.io issue-term=pathname theme=github-dark crossorigin=anonymous async></script><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents></nav></div></aside></main></body></html>